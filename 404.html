<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image Viewer</title>
    <link rel="stylesheet" href="style.css">
    <!-- Only config and the SystemManager entry point are needed here. -->
    <script src="config.js"></script>
    <script src="SystemManager.js"></script>
</head>
<body>
    <div class="container">
        <h1>Image Viewer</h1>
        <div id="image-display">
            <!-- The decoded image will be placed here -->
            <p id="loading-message">Decoding image from URL...</p>
        </div>
        <div id="error-display" class="hidden">
            <h2>Error</h2>
            <p id="error-message"></p>
        </div>
    </div>

    <!-- 
      The DOMContentLoaded event ensures the page structure is ready.
      The SystemManager.initialize function is now async, so we await its completion.
      This single call will load all other scripts and start the application.
    -->
    <script>
        document.addEventListener('DOMContentLoaded', async () => {
            try {
                // Initialize the system. This will handle loading all other scripts
                // and automatically start the decoding process for the 404 page.
                await SystemManager.initialize(config);
            } catch (error) {
                console.error("Fatal error during system initialization:", error);
                // Display a user-friendly error message on the page as a fallback.
                document.body.innerHTML = '<div style="text-align: center; padding: 2rem;"><h1>Application Error</h1><p>Could not start the application. Please see the browser console for more details.</p></div>';
            }
        });
    </script>
</body>
</html>
